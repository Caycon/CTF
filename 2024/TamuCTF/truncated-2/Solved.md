**Chall:**
- [flag.txt.enc](https://github.com/Caycon/CTF/blob/main/2024/TamuCTF/truncated-2/flag.txt.enc)
- [private.pem](https://github.com/Caycon/CTF/blob/main/2024/TamuCTF/truncated-2/private.pem)
- [public.pem](https://github.com/Caycon/CTF/blob/main/2024/TamuCTF/truncated-2/public.pem)

**Solved:**
- Chall này tương tự với chall trên. Tuy nhiên sau khi thử các trường hợp thì ta xác định được thứ có trong private key là $dp$ và $dq$.
- Ta sẽ tìm $p, q$ từ $dp$ và $dq$:
```Python
e = 65537
# dq = 0x94e9fa2c26b0e1c631ced2f86be0207a82751d707b018839565e93f551df596e9d16f05599a2bfb0bbb300064139f383de85c793e058da2cce41a9a0398e40be05bb9b82703fe804164f5ff4d76623d0e4c720fd705ce6eface979489a8b3a2bd6630077699c0aa8da6250c1de8840d3e5afc34db865e0650ce08f828b49ad
dp = 0x54d4d1981870d799334e5ae5174526d2979e14c6ecc74d7b59600fbf7db4c060481c3d38c83aa4048e4c6ad483a416d43aecc58db7fe8b9e3d114187538c02b22c9197fe3afd23a83f6e9ac33fab55c84776b1de23a6057e91c47e36ab2ac7600adbbfeb4159d8b09d81898f9a04e47b679cbe690daf6a60551f2b8227863377
n= 25738076489477390048107389684996103882556969202513166288259522036337632736404168235030854616722305580161628671792338702584031628109920559959142086244929697000719839651284769225292474824312234101039383526660410096665677108899401181859913502426847877961086164703198858818644081120668614573404426468513602005820885294275008357193783600514925643269093575426795017766522751748746504263462858714066992146006524560800527477669712171172719903914727042988942644713692028132153937805550877286612258743238152980687480412165259102950423845139742038860174525053539636028083341480124394591958643772596948645492958078465902879395979
for kp in range(3, e):
    p_mul = dp * e - 1
    if p_mul % kp == 0:
        p = (p_mul // kp) + 1
        if n%p==0:
            print(p)
```
- Sau khi có $p$ ta tiến hành decrypt RSA như bình thường:

```Python
# with open('flag.txt.enc', 'rb') as file:
#     data = file.read()
# print(data)
from Crypto.Util.number import *
# print(bytes_to_long(data))
c= 18147789538491672247014835915533602634489783982570184852263130618880895586248510445762793030371772706661903854549522471443489220781151105324395882066129000312901593158718085272159445937780138941087393906131816926837889736944766699516384704335490626882966822721575551789099653648497421444960166756605357079875531002141548345722807396537903265766533712341901884965838493489973962274253970778333560877488158894465781306717489093950490283941677862290948756892133460933354821306503592346279215675049394535928238443884190882236936573982447875998833104600427426373831025442349266689261023328525768063776127379020358376633359
n= 25738076489477390048107389684996103882556969202513166288259522036337632736404168235030854616722305580161628671792338702584031628109920559959142086244929697000719839651284769225292474824312234101039383526660410096665677108899401181859913502426847877961086164703198858818644081120668614573404426468513602005820885294275008357193783600514925643269093575426795017766522751748746504263462858714066992146006524560800527477669712171172719903914727042988942644713692028132153937805550877286612258743238152980687480412165259102950423845139742038860174525053539636028083341480124394591958643772596948645492958078465902879395979
d= 12268824512275772386810243311163283673215185697076956487566473763712830712488858327452002387103718827071154283719167668455180667641679091362504779856891427205863698565262694095214218169413660473820545943730610043394450181701016870366806208859227574875547227892507401444588941113404041184438187551591993121583602393885510874156545263131103334857194262954770398233345115952926164387192469033296266648827977189582367013228288930396380493334398360992251861258101200542222507575294262416118075775042888662993391374311529317870432232600847436532469480516923816627557760499730108612650549333497706472411035774120393055066730281813207250666720120808481969918329382463603007280018825500155541029165398696448449363179323150462614156413960204095770066697533116892293312350616801101349036069599434691122396548136377875429834713160316170508100945678460832726195329817570167328447135224096768433488572851355462612083642812403668314158847536478384635955464930823362733038837541077572917369042940489551144338858857187628575414016271818007762475510785496798329982498683147903523627859356628874260506162550889815766908590651452027038179984523010515738082999723013861117536829826149670032878021945501021040865902387608988226937055014990449865971685666998471636092856436190943511059890124150707618225437585423320801098235026928780987
p= 146499949876031596595119473544158492278112465965128296098554215599527541093216463269448197726258519438043835011477106576649738579124758942019192335365960513430943680607378942906030476700381704046104806602324753526654817790452245515616252739559328483440653497757953778117237609624419671326102551735126101243367
q= n//p
print(q)
phi= (p-1)*(q-1)
d= pow(65537,-1,phi)
flag= long_to_bytes(pow(c, d, n))
print(flag)
```
- Flag: `gigem{DP_DQ_r54_7rUNC473D_SDA79}`
